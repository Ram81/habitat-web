{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/createClass.js","webpack:///./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///./node_modules/@babel/runtime/helpers/typeof.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack:///./task/habitat_web_app/bindings.css?a698","webpack:///./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack:///./task/habitat_web_app/bindings.css","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///./task/habitat_web_app/modules/defaults.js","webpack:///./task/habitat_web_app/modules/utils.js","webpack:///./task/habitat_web_app/modules/event_logger.js","webpack:///./task/habitat_web_app/modules/simenv_embind.js","webpack:///./task/habitat_web_app/modules/task_validator.js","webpack:///./task/habitat_web_app/modules/objectnav_task.js","webpack:///./task/habitat_web_app/modules/inventory.js","webpack:///./task/habitat_web_app/modules/pick_place_task.js","webpack:///./task/habitat_web_app/modules/web_demo.js","webpack:///./task/habitat_web_app/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","instance","Constructor","TypeError","_defineProperties","target","props","length","descriptor","configurable","writable","protoProps","staticProps","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","arr","obj","_typeof","iterator","constructor","Array","isArray","_i","_s","_e","_arr","_n","_d","next","done","push","err","arrayLikeToArray","minLen","toString","slice","from","test","len","arr2","api","content","default","options","locals","memo","isOldIE","Boolean","window","document","all","atob","getTarget","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","e","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","list","idCountMap","identifiers","item","id","base","count","concat","index","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","keys","forEach","setAttribute","insert","Error","appendChild","textStore","replaceText","replacement","filter","join","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","btoa","unescape","encodeURIComponent","JSON","stringify","firstChild","singleton","singletonCounter","update","styleIndex","parentNode","removeStyleElement","newObj","lastIdentifiers","newList","newLastIdentifiers","_index","splice","___CSS_LOADER_API_IMPORT___","useSourceMap","this","map","cssMapping","sourceMapping","base64","data","sourceURLs","sources","source","sourceRoot","cssWithMappingToString","mediaQuery","dedupe","alreadyImportedModules","defaultAgentConfig","height","radius","mass","linearAcceleration","angularAcceleration","Math","PI","linearFriction","angularFriction","coefficientOfRestitution","defaultEpisode","startState","position","rotation","goal","defaultResolution","width","defaultScene","location","href","indexOf","primitiveObjectHandles","largeScenes","taskConfigs","objectnav","sensorConfig","actions","sliding","actuationSpec","move","turn","rearrangement","buildConfigFromURLParameters","config","search","substr","split","arg","decodeURIComponent","readJSON","url","encoding","contentsRaw","FS","readFile","contents","parse","buildEpisodeFromJSON","task","episode_id","dataset","episodeJSON","episode","episodeID","episodes","start_position","start_rotation","sceneID","scene_id","objects","scenePath","parseInt","object_category","goal_id","scene_dataset","goals_by_category","includes","goals","is_thda","scene_state","info","start_room","shortest_paths","instruction","type","loadEpisode","episodeConfigPath","undefined","getEpisodeMeta","sceneConfig","episodeId","protocol","host","request","XMLHttpRequest","open","send","status","response","getObjectConfig","objectName","objectHandle","objectId","objectIcon","physicsProperties","renderMesh","PsiturkEventLogger","psiturk","phase","event","disableLogging","recordTrialData","recordUnstructuredData","SimEnv","agentId","textureDownsampleFactor","sim","Module","Simulator","pathfinder","getPathFinder","psiTurk","resolution","grippedObjectId","nearestObjectId","gripOffset","selectedAgentId","agentObjectHandle","setEpisode","maxDistance","islandRadiusLimit","recomputeNavMesh","reset","initialAgentState","getAgent","setState","handleRecordTrialData","removeAllObjects","objectsInScene","initialize_THDA_episode","createAgentState","addContactTestObject","sort","a","b","keyA","keyB","objectLibHandle","convertVec3fToVector3","quatFromCoeffs","addObjectAtLocation","MotionType","DYNAMIC","addObjectInScene","episodeCopy","idx","objectTemplate","STATIC","postion","updateCrossHairNode","prevObjectId","newObjectId","syncGrippedObject","motionType","addObjectByHandle","setTranslation","setRotation","setObjectMotionType","existingObjectIds","getExistingObjectIDs","size","getObjectFromScene","removeObject","removeContactTestObject","clearRecycledObjectIds","action","checkCollision","agent","agentTransform","getAgentTransformation","isAgentColliding","act","agentConfig","createAgentConfig","flipVec2i","sensorSpecifications","addAgent","objectLibIndex","addObject","primitiveObjectIdx","max","floor","random","getRandomInt","transformPoint","Vector3","getObjectUnderCrosshair","setTransformation","mul","getTranslation","isNavigable","convertVector3ToVec3f","console","log","drawBBAroundNearestObject","inverted","getTransformation","KINEMATIC","grabAction","releaseAction","actionData","findObjectFloorPositionUnderCrosshair","newObjectPosition","actionFailed","updateObjectInScene","newObjectTranslation","grippedObjectTransformation","objectUnderCrosshair","actionMeta","sensorId","getAgentObservationSpace","obs","getAgentObservation","objectID","getObjectMotionType","sceneId","transform","translation","getRotation","drawBB","setObjectBBDraw","dt","stepWorld","getWorldTime","displayObservation","getSemanticScene","contactTest","getAgentAbsoluteTranslation","getAgentRotation","getAgentSensorSuite","state","AgentState","getState","element","crossHairPosition","getCrosshairPosition","crossHairPoint","unproject","direction","refPoint","findNearestObjectUnderCrosshair","x","y","z","updateDropPointNode","refTransform","floorPosition","findFloorPositionUnderCrosshair","point","collision","isCollision","snappedPoint","snapPoint","isOnSeparateIsland","islandRadius","y_diff","abs","sampleObjectState","navMeshSettings","NavMeshSettings","agentRadius","agentHeight","setNavMeshVisualization","windowSize","backward","newPosition","add","filterDiff","tryStep","sub","isColliding","offsets","offset","finalPosition","isNavigationTest","collisionGroup","collisionMask","preAddContactTest","positionA","positionB","path","ShortestPath","requestedStart","requestedEnd","findPath","geodesicDistance","sourceObjectId","destinationObjectId","sourcePosition","destinationPosition","getObjectBBYCoord","getNumActiveContactPoints","getSceneBB","objectStates","objectState","coeffFromQuat","agentPosition","agentRotation","sensors","sensorKeys","sensorData","coeff","vector","scalar","Quaternion","sqrt","enableDebugDraw","dst","getAgentState","src","dv","applyRotation","cartesian_to_polar","v","q","qx","qy","qz","qw","ix","iy","iz","iw","atan2","converted","SensorSpec","AgentConfiguration","sensorSpecs","VectorSensorSpec","push_back","createSensorSpec","TaskValidator","validateArrangementTask","validateCleaningTask","validateObjectNavTHDATask","validateObjectNavTask","objectToReceptacleMap","objectToGoalMap","getObjectsInScene","taskStarted","objectsInitialState","objectInitialTranslation","objectTranslation","receptacles","success","receptacleObjectId","receptaclePosition","distance","receptacleY","taskSuccess","objectGoal","viewPointt","view_points","agent_state","euclideanDistance","lifted","numObjectsMoved","ObjectNavTask","components","keyBindListener","taskValidator","keyCode","bindKeys","initialized","initRendering","activeActions","activeActionIdx","frameCounter","frameRate","runFlythrough","renderingFunction","setInterval","popAction","handleAction","render","clearInterval","disableRendering","setStatus","epsiode","text","innerHTML","renderImage","validate","step","logData","agentState","getAgentPose","removeActiveAction","pushAction","_self","preventDefault","handleKeypress","addEventListener","keyBindListener2","handleKeypressUp","removeEventListener","Inventory","inventorySlots","inventory","inventoryComponent","inventoryEnabled","inventoryCtx","component","getContext","border","ctx","clearRect","fillStyle","boxOffset","beginPath","strokeStyle","lineWidth","rect","stroke","closePath","img","Image","drawImage","padding","boxSize","PickPlaceTask","lastInteractedObjectId","initInventory","initPhysics","numRendersSinceLastUpdate","enablePhysics","physicsStepFunction","stepSize","startTime","Date","getTime","getObjectStates","objectDropPoint","totalTime","disablePhysics","renderInventory","showDropPoint","slot","findObjectSlot","setSlot","emptySlot","getEmptySlot","inventoryGrabReleaseObject","handleInventoryUpdate","setErrorStatus","WebDemo","canvasId","SimulatorConfiguration","allowSliding","scene","physicsConfigFile","simenv","task_type","updateAgentConfigWithSensors","canvasElement","getElementById","instantiateTask","canvas","fps","scope","taskInstruction","assistance","objectIconTags","objectImgTags","charAt","toUpperCase","getObjectIconImgTags","setTaskValidator","actualTask","taskConfig","trainingEpisode","trainingTask","sensorConfigs","uuid","sensorType","SensorType","COLOR","hfov","actionSpace","ActionSpace","moveActuationSpec","MapStringFloat","set","turnActuationSpec","ActionSpec","updateAgentConfigWithResolution","currentResolution","useDefaultEpisode","initializeModules","init","validateTask","preload","file","splits","createPreloadedFile","preRun","args","trim","j","arguments","substring","datasetPath","taskHome","getTaskConfigPath","objectsToLoad","objectConfigs","objectTemplateSplit","objectConfig","uniqueObjectIds","getObjects","defaultPhysConfig","objectsToLoadList","emDataHome","mkdir","emObjHome","objectIdx","physicsPropertyName","renderMeshName","preloadPhysConfig","splittedPath","taskName","preloadTask","fileNoExtension","lastIndexOf","semantic","mainUrl","moreThanOne","pop","infoSemanticPath","getInfoSemanticUrl","onRuntimeInitialized","demo","display","webgl2Support","hasWebgl","WebGL2RenderingContext","checkWebgl2Support","message","WebAssembly","instantiate","Uint8Array","of","Instance","checkWebAssemblySupport","warningElement","className","checkSupport"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithHoles = require(\"./arrayWithHoles.js\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableRest = require(\"./nonIterableRest.js\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\n\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var api = require(\"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../node_modules/css-loader/dist/cjs.js!./bindings.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"/** Copyright (c) Facebook, Inc. and its affiliates.\\n *  This source code is licensed under the MIT license found in the\\n *  LICENSE file in the root directory of this source tree.\\n */\\n#radar {\\n  position: absolute;\\n  top: 70%;\\n  left: 50%;\\n  margin-left: -50px;\\n  width: 100;\\n  height: 100;\\n  z-index: 9;\\n  pointer-events: none;\\n  visibility: hidden;\\n}\\n\\n#scope {\\n  position: absolute;\\n  border-color: red;\\n  border-style: dashed;\\n  border-width: 5px;\\n  opacity: 0.4;\\n  top: 50%;\\n  left: 50%;\\n  margin-left: -160px;\\n  margin-top: -120px;\\n  width: 320px;\\n  height: 240px;\\n  z-index: 9;\\n  pointer-events: none;\\n}\\n\\n#fps {\\n  text-align: right;\\n  margin-left: auto;\\n  margin-right: auto;\\n  width: 800px;\\n  font-size: 15pt;\\n  font-family: monospace;\\n}\\n\\n#warning {\\n  position: absolute;\\n  top: 0;\\n  bottom: 0;\\n  left: 0;\\n  right: 0;\\n  z-index: 100;\\n  background-color: #fff;\\n  color: #000;\\n}\\n\\n.hidden {\\n  display: none !important;\\n}\\n\\n.inventory-center {\\n  margin-top: 1.5em;\\n  text-align: center;\\n}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","// Copyright (c) Facebook, Inc. and its affiliates.\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nexport const defaultAgentConfig = {\n  height: 0.88,\n  radius: 0.18,\n  mass: 32.0,\n  linearAcceleration: 20.0,\n  angularAcceleration: 4 * Math.PI,\n  linearFriction: 0.5,\n  angularFriction: 1.0,\n  coefficientOfRestitution: 0.0\n};\n\nexport const defaultStartState = {\n  position: [-4.94049, -2.63092, -7.57733],\n  rotation: [0, 0.980792, 0, 0.195056]\n};\n\nexport const defaultGoal = {\n  position: [2.2896811962127686, 0.11950381100177765, 16.97636604309082]\n};\n\nexport const defaultEpisode = {\n  startState: defaultStartState,\n  goal: defaultGoal\n};\n\nexport const defaultResolution = { height: 480, width: 640 };\n\nexport const defaultScene =\n  window.location.href.indexOf(\"localhost\") === -1\n    ? \"https://habitat-resources.s3.amazonaws.com/data/scene_datasets/habitat-test-scenes/skokloster-castle.glb\"\n    : \"skokloster-castle.glb\";\n\nexport const infoSemanticFileName = \"info_semantic.json\";\n\nexport const dataHome = \"data/\";\nexport const taskHome = \"data/tasks/\";\nexport const sceneHome = \"data/scenes/\";\nexport const primitiveObjectHandles = [\n  \"cylinderSolid_rings_1_segments_12_halfLen_1_useTexCoords_false_useTangents_false_capEnds_true\"\n];\n\nexport const inventorySlots = 1;\n\nexport const largeScenes = [\n  \"B6ByNegPMKs.glb\",\n  \"kEZ7cmS4wCh.glb\",\n  \"dhjEzFoUFzH.glb\",\n  \"E9uDoFAP3SH.glb\",\n  \"vyrNrziPKCB.glb\"\n];\n\nexport const taskConfigs = {\n  objectnav: {\n    sensorConfig: {\n      position: [0.0, 0.88, 0.0]\n    },\n    actions: [\"moveForward\", \"turnLeft\", \"turnRight\", \"lookUp\", \"lookDown\"],\n    sliding: false,\n    actuationSpec: {\n      move: 0.25,\n      turn: 30.0\n    }\n  },\n  rearrangement: {\n    sensorConfig: {\n      position: [0, 1.5, 0]\n    },\n    actions: [\n      \"moveForward\",\n      \"turnLeft\",\n      \"turnRight\",\n      \"lookUp\",\n      \"lookDown\",\n      \"moveBackward\"\n    ],\n    sliding: true,\n    actuationSpec: {\n      move: 0.15,\n      turn: 5.0\n    }\n  }\n};\n","// Copyright (c) Facebook, Inc. and its affiliates.\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\n/* global FS */\n\nimport { infoSemanticFileName, defaultEpisode, taskHome } from \"./defaults\";\n\n/**\n *\n * @param {function} func Function to be throttled\n * @param {int} timeout Milliseconds interval after which throttle will be called,\n * `func` will be called at least once in the timeout timeframe.\n */\nexport function throttle(func, timeout = 500) {\n  let active = false;\n\n  return function() {\n    const args = arguments;\n    const context = this;\n    if (!active) {\n      func.apply(context, args);\n      active = true;\n      window.setTimeout(() => {\n        active = false;\n      }, timeout);\n    }\n  };\n}\n\n/**\n * Check whether web assembly is supported on the current browser or not.\n * Returns false if not otherwise true.\n */\nexport function checkWebAssemblySupport() {\n  try {\n    if (\n      typeof WebAssembly === \"object\" &&\n      typeof WebAssembly.instantiate === \"function\"\n    ) {\n      const module = new WebAssembly.Module(\n        Uint8Array.of(0x0, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00)\n      );\n      if (module instanceof WebAssembly.Module) {\n        return new WebAssembly.Instance(module) instanceof WebAssembly.Instance;\n      }\n    }\n  } catch (e) {\n    return false;\n  }\n  return false;\n}\n\n/**\n * Checks for WebGL2 support in current browser.\n * Returns 0 if there is no support, 1 if support is there but disabled otherwise 2.\n */\nexport function checkWebgl2Support() {\n  let canvas;\n  let ctx;\n  let hasWebgl = false;\n\n  try {\n    canvas = document.createElement(\"canvas\");\n    ctx = canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\");\n  } catch (e) {\n    return;\n  }\n\n  if (ctx !== undefined) {\n    hasWebgl = true;\n  }\n\n  canvas = undefined;\n  if (!hasWebgl) {\n    if (typeof WebGL2RenderingContext !== \"undefined\") {\n      return 1;\n    } else {\n      return 0;\n    }\n  } else {\n    return 2;\n  }\n}\n\nexport function getInfoSemanticUrl(mainUrl) {\n  const splits = mainUrl.split(\"/\");\n  const moreThanOne = splits.length > 1;\n  splits.pop();\n  let infoSemanticPath = infoSemanticFileName;\n  if (moreThanOne) {\n    infoSemanticPath = \"/\" + infoSemanticPath;\n  }\n  return splits.join(\"/\") + infoSemanticPath;\n}\n\nexport function buildConfigFromURLParameters(config = {}) {\n  for (let arg of window.location.search.substr(1).split(\"&\")) {\n    let [key, value] = arg.split(\"=\");\n    if (key && value) {\n      config[key] = decodeURIComponent(value);\n    }\n  }\n  return config;\n}\n\nexport function getRandomInt(max = 5) {\n  return Math.floor(Math.random() * max);\n}\n\nexport function readJSON(url, options = { encoding: \"utf8\" }) {\n  let contentsRaw = FS.readFile(url, { encoding: options[\"encoding\"] });\n  let contents = JSON.parse(contentsRaw);\n  return contents;\n}\n\nexport function buildEpisodeFromJSON(\n  task = \"task.json\",\n  episode_id = \"0\",\n  dataset = \"pick_and_place\"\n) {\n  let episodeJSON = readJSON(task);\n  let episode = {};\n  episode.startState = {};\n  if (dataset == \"pick_and_place\") {\n    episode.episodeID = episode_id;\n    episode.startState.position =\n      episodeJSON.episodes[episode_id].start_position;\n    episode.startState.rotation =\n      episodeJSON.episodes[episode_id].start_rotation;\n    episode.sceneID = episodeJSON.episodes[episode_id].scene_id;\n    episode.objects = episodeJSON.episodes[episode_id].objects;\n    episode.task = episodeJSON.episodes[episode_id].task;\n  } else {\n    let scenePath = episodeJSON.episodes[episode_id].scene_id.split(\"/\");\n    episode.episode_id = parseInt(episodeJSON.episodes[episode_id].episode_id);\n    episode.startState.position =\n      episodeJSON.episodes[episode_id].start_position;\n    episode.startState.rotation =\n      episodeJSON.episodes[episode_id].start_rotation;\n    episode.scene_id = episodeJSON.episodes[episode_id].scene_id;\n    episode.object_category = episodeJSON.episodes[episode_id].object_category;\n    let goal_id =\n      scenePath[scenePath.length - 1] + \"_\" + episode.object_category;\n\n    episode.scene_dataset = episodeJSON.episodes[episode_id].scene_dataset;\n    if (!Object.keys(episodeJSON.goals_by_category).includes(goal_id)) {\n      episode.is_thda = true;\n      episode.goals = episodeJSON.episodes[episode_id].goals;\n      episode.scene_state = episodeJSON.episodes[episode_id].scene_state;\n      episodeJSON.goals_by_category = null;\n    } else {\n      episode.goals = episodeJSON.goals_by_category[goal_id];\n    }\n    episode.info = episodeJSON.episodes[episode_id].info;\n    episode.start_room = episodeJSON.episodes[episode_id].start_room;\n    episode.shortest_paths = episodeJSON.episodes[episode_id].shortest_paths;\n    episode.task = {\n      instruction: \"Find and go to \" + episode.object_category,\n      type: \"objectnav\"\n    };\n  }\n  return episode;\n}\n\nexport function replaceAll(str, needle, replacement) {\n  while (str.indexOf(needle) !== -1) {\n    str = str.replace(needle, replacement);\n  }\n  return str;\n}\n\nexport function loadEpisode(\n  episodeConfigPath,\n  episode_id = \"0\",\n  dataset = \"pick_and_place\"\n) {\n  let episode;\n  if (episodeConfigPath === undefined) {\n    episode = defaultEpisode;\n  } else if (episode_id === undefined) {\n    episode = buildEpisodeFromJSON(episodeConfigPath);\n  } else {\n    episode = buildEpisodeFromJSON(episodeConfigPath, episode_id, dataset);\n  }\n  return episode;\n}\n\nexport function compareObjectStates(gtObjectState, objectState) {\n  let objectId = objectState[\"objectId\"];\n  let actualId = gtObjectState[\"objectId\"];\n  if (objectId == actualId) {\n    let trans = objectState[\"translation\"];\n    let actualTrans = gtObjectState[\"translation\"];\n    if (JSON.stringify(trans) === JSON.stringify(actualTrans)) {\n      let rot = objectState[\"rotation\"];\n      let actualRot = gtObjectState[\"rotation\"];\n\n      if (JSON.stringify(rot) !== JSON.stringify(actualRot)) {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  } else {\n    return false;\n  }\n  return true;\n}\n\nexport function getObjectIconImgTags(episode) {\n  if (episode.objects == undefined) {\n    return {\n      objects: [],\n      receptacles: []\n    };\n  }\n  let objects = episode[\"objects\"];\n  let objectImgTags = {};\n  objectImgTags[\"objects\"] = [];\n  objectImgTags[\"receptacles\"] = [];\n  for (let i = 0; i < objects.length; i++) {\n    let object = objects[i];\n    let objectName = object[\"object\"];\n    objectName = objectName.charAt(0).toUpperCase() + objectName.slice(1);\n    let item =\n      \"<div><img src='\" +\n      object[\"objectIcon\"] +\n      \"' style='border: 3px solid grey'/><div class='img-caption'>\" +\n      objectName +\n      \"</div></div>\";\n\n    if (object[\"isReceptacle\"]) {\n      objectImgTags[\"receptacles\"].push(item);\n    } else {\n      objectImgTags[\"objects\"].push(item);\n    }\n  }\n  return objectImgTags;\n}\n\nexport function getHost() {\n  return window.location.protocol + \"//\" + window.location.host;\n}\n\nexport function getEpisodeMeta(sceneConfig, episodeId) {\n  // read config from URL location\n  let url = getHost() + \"/\" + sceneConfig;\n  var request = new XMLHttpRequest();\n  request.open(\"GET\", url, false);\n  request.send(null);\n\n  if (request.status == 200) {\n    let response = JSON.parse(request.response);\n    let episode = response.episodes[episodeId];\n\n    if (episode == undefined) {\n      episode = response.episodes[0];\n    }\n    return episode;\n  }\n  return null;\n}\n\nexport function getObjects(episode, trainingEpisode, dataset) {\n  let objectConfigs = [];\n  if (dataset == \"objectnav\") {\n    let scene_state = episode.scene_state;\n    if (scene_state == undefined) {\n      return [];\n    }\n    for (let idx in scene_state.objects) {\n      let object = scene_state.objects[idx];\n      let objectTemplate = object[\"object_template\"];\n      let objectTemplateSplit = objectTemplate.split(\"/\");\n      let objectName = objectTemplateSplit[objectTemplateSplit.length - 1];\n\n      let objectConfig = getObjectConfig(objectName.split(\".\")[0], objectName);\n      objectConfigs.push(objectConfig);\n    }\n    scene_state = trainingEpisode.scene_state;\n    for (let idx in scene_state.objects) {\n      let object = scene_state.objects[idx];\n      let objectTemplate = object[\"object_template\"];\n      let objectTemplateSplit = objectTemplate.split(\"/\");\n      let objectName = objectTemplateSplit[objectTemplateSplit.length - 1];\n\n      let objectConfig = getObjectConfig(objectName.split(\".\")[0], objectName);\n      objectConfigs.push(objectConfig);\n    }\n  } else {\n    let objects = episode.objects;\n    let uniqueObjectIds = [];\n    for (let idx in objects) {\n      let object = objects[idx];\n      let objectTemplate = object[\"objectHandle\"];\n      let objectTemplateSplit = objectTemplate.split(\"/\");\n      let objectName = objectTemplateSplit[objectTemplateSplit.length - 1];\n\n      if (!uniqueObjectIds.includes(objectName)) {\n        let objectConfig = getObjectConfig(\n          objectName.split(\".\")[0],\n          objectName\n        );\n        objectConfigs.push(objectConfig);\n        uniqueObjectIds.push(objectName);\n      }\n    }\n\n    objects = trainingEpisode.objects;\n    for (let idx in objects) {\n      let object = objects[idx];\n      let objectTemplate = object[\"objectHandle\"];\n      let objectTemplateSplit = objectTemplate.split(\"/\");\n      let objectName = objectTemplateSplit[objectTemplateSplit.length - 1];\n\n      if (!uniqueObjectIds.includes(objectName)) {\n        let objectConfig = getObjectConfig(\n          objectName.split(\".\")[0],\n          objectName\n        );\n        objectConfigs.push(objectConfig);\n        uniqueObjectIds.push(objectName);\n      }\n    }\n  }\n  return objectConfigs;\n}\n\nexport function getObjectConfig(objectName, objectHandle) {\n  let objectId = objectHandle.split(\".\")[0];\n  return {\n    object: objectName,\n    objectIcon: \"/data/test_assets/objects/\" + objectId + \".png\",\n    objectHandle: \"/data/objects/\" + objectHandle,\n    physicsProperties: \"test_assets/objects/\" + objectHandle,\n    renderMesh: \"test_assets/objects/\" + objectId + \".glb\"\n  };\n}\n\nexport function getTaskConfigPath(sceneId, dataset) {\n  if (dataset == \"pick_and_place\") {\n    let path = taskHome + \"pick_and_place/\" + sceneId + \".json\";\n    return path;\n  } else if (dataset == \"objectnav\") {\n    let path = taskHome + \"objectnav_mp3d_v6/\" + sceneId + \".json\";\n    return path;\n  }\n  let defaultPath = taskHome + sceneId + \".json\";\n  return defaultPath;\n}\n","/**\n * PsiturkEventLogger class\n */\nclass PsiturkEventLogger {\n  // PUBLIC methods.\n\n  /**\n   * Create navigate task.\n   * @param {SimEnv} sim - simulator\n   */\n  constructor(psiturk) {\n    this.psiturk = psiturk;\n  }\n\n  handleRecordTrialData(phase, event, data) {\n    if (this.psiturk && window.config.disableLogging == false) {\n      this.psiturk.recordTrialData({\n        phase: phase,\n        event: event,\n        data: data\n      });\n    }\n  }\n\n  handleRecordUnstructuredData(key, value) {\n    if (this.psiturk && window.config.disableLogging == false) {\n      this.psiturk.recordUnstructuredData(key, value);\n    }\n  }\n}\n\nexport default PsiturkEventLogger;\n","// Copyright (c) Facebook, Inc. and its affiliates.\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\n/*global Module */\n\nimport {\n  primitiveObjectHandles,\n  largeScenes,\n  defaultAgentConfig\n} from \"./defaults\";\nimport { getRandomInt } from \"./utils\";\nimport PsiturkEventLogger from \"./event_logger\";\n\n/**\n * SimEnv class\n *\n * TODO(aps,msb) - Add support for multiple agents instead of\n * hardcoding 0th one.\n */\nclass SimEnv {\n  // PUBLIC methods.\n\n  /**\n   * Create a simulator.\n   * @param {Object} config - simulator config\n   * @param {Object} episode - episode to run\n   * @param {number} agentId - default agent id\n   */\n  constructor(config, episode = {}, agentId = 0) {\n    // Downsample textures of large scenes for fast rendering on client\n    if (largeScenes.includes(config.scene_id)) {\n      config.textureDownsampleFactor = 1;\n    }\n    this.sim = new Module.Simulator(config);\n    this.pathfinder = this.sim.getPathFinder();\n    this.psiturk = new PsiturkEventLogger(window.psiTurk);\n\n    this.resolution = null;\n    this.grippedObjectId = -1;\n    this.nearestObjectId = -1;\n    this.gripOffset = null;\n    this.selectedAgentId = agentId;\n    this.agentObjectHandle = primitiveObjectHandles[0];\n\n    this.setEpisode(episode);\n    this.maxDistance = 2.0;\n    this.islandRadiusLimit = 1.8;\n    this.recomputeNavMesh();\n  }\n\n  /**\n   * Resets the simulation.\n   */\n  reset() {\n    this.sim.reset();\n    if (this.initialAgentState !== null) {\n      const agent = this.sim.getAgent(this.selectedAgentId);\n      agent.setState(this.initialAgentState, true);\n    }\n\n    this.grippedObjectId = -1;\n    this.nearestObjectId = -1;\n    this.gripOffset = null;\n    this.psiturk.handleRecordTrialData(\"TEST\", \"simReset\", {});\n  }\n\n  /**\n   * Change selected agent in the simulation.\n   * @param {number} agentId - agent id\n   */\n  changeAgent(agentId) {\n    this.selectedAgentId = agentId;\n  }\n\n  /**\n   * Set episode and initialize agent state.\n   * @param {Object} episode - episode config\n   */\n  setEpisode(episode = {}) {\n    this.removeAllObjects();\n    this.episode = episode;\n    this.initialAgentState = null;\n    this.objectsInScene = [];\n\n    this.initialize_THDA_episode(episode);\n    if (Object.keys(episode).length > 0) {\n      this.initialAgentState = this.createAgentState(episode.startState);\n      // add agent object for collision test\n      this.sim.addContactTestObject(this.agentObjectHandle, 0);\n      if (episode.objects !== undefined) {\n        let objects = JSON.parse(JSON.stringify(episode.objects));\n\n        objects.sort(function(a, b) {\n          var keyA = a[\"objectId\"];\n          var keyB = b[\"objectId\"];\n\n          if (keyA < keyB) {\n            return -1;\n          }\n          if (keyA > keyB) {\n            return 1;\n          }\n          return 0;\n        });\n        for (let index in objects) {\n          let objectLibHandle = objects[index][\"objectHandle\"];\n          let position = this.convertVec3fToVector3(objects[index][\"position\"]);\n          let rotation = this.quatFromCoeffs(objects[index][\"rotation\"]);\n\n          let objectId = this.addObjectAtLocation(\n            objectLibHandle,\n            position,\n            rotation,\n            Module.MotionType.DYNAMIC\n          );\n          this.addObjectInScene(objectId, objects[index]);\n          // adding contact test shape for object\n          this.sim.addContactTestObject(objectLibHandle, 0);\n          episode.objects[index][\"simObjectId\"] = objectId;\n          episode.objects[index][\"prevObjectId\"] =\n            episode.objects[index][\"objectId\"];\n          episode.objects[index][\"objectId\"] = objectId;\n        }\n      }\n    } else {\n      // add agent object for collision test\n      this.sim.addContactTestObject(this.agentObjectHandle, 0);\n    }\n    let episodeCopy = JSON.parse(JSON.stringify(episode));\n    if (window.config.dataset == \"objectnav\" && episode.is_thda != true) {\n      episodeCopy.goals = [];\n    }\n    this.psiturk.handleRecordTrialData(\"TEST\", \"setEpisode\", {\n      episode: episodeCopy\n    });\n  }\n\n  initialize_THDA_episode(episode) {\n    let scene_state = episode.scene_state;\n    if (scene_state !== undefined) {\n      let objects = scene_state.objects;\n\n      for (let idx in objects) {\n        let object = objects[idx];\n\n        let objectTemplate = object[\"object_template\"].split(\"/\");\n        let objectLibHandle =\n          \"/data/objects/\" +\n          objectTemplate[objectTemplate.length - 1] +\n          \".object_config.json\";\n        let position = this.convertVec3fToVector3(object[\"position\"]);\n        let rotation = this.quatFromCoeffs(object[\"rotation\"]);\n\n        this.addObjectAtLocation(\n          objectLibHandle,\n          position,\n          rotation,\n          Module.MotionType.STATIC\n        );\n      }\n      this.recomputeNavMesh();\n    }\n  }\n\n  /**\n   * Update cross hair node position.\n   */\n  updateCrossHairNode(postion) {\n    this.sim.updateCrossHairNode(postion);\n  }\n\n  addObjectInScene(objectId, objectTemplate) {\n    let object = JSON.parse(JSON.stringify(objectTemplate));\n    object[\"objectId\"] = objectId;\n    this.objectsInScene.push(object);\n  }\n\n  updateObjectInScene(prevObjectId, newObjectId) {\n    for (let index = 0; index < this.objectsInScene.length; index++) {\n      if (this.objectsInScene[index][\"objectId\"] == prevObjectId) {\n        this.objectsInScene[index][\"objectId\"] = newObjectId;\n        break;\n      }\n    }\n  }\n\n  getObjectFromScene(objectId) {\n    for (let index = 0; index < this.objectsInScene.length; index++) {\n      if (this.objectsInScene[index][\"objectId\"] == objectId) {\n        return this.objectsInScene[index];\n      }\n    }\n    return null;\n  }\n\n  getObjectsInScene() {\n    return this.objectsInScene;\n  }\n\n  /**\n   * Sync objects grabbed by agent to agent body.\n   */\n  syncObjects() {\n    this.sim.syncGrippedObject(this.grippedObjectId);\n  }\n\n  /**\n   * Adds a dynamic object at specific position in simulation.\n   */\n  addObjectAtLocation(\n    objectLibHandle,\n    position,\n    rotation,\n    motionType = Module.MotionType.STATIC\n  ) {\n    let objectId = this.addObjectByHandle(objectLibHandle);\n    this.setTranslation(position, objectId, 0);\n    this.setRotation(rotation, objectId, 0);\n    this.setObjectMotionType(motionType, objectId, 0);\n    return objectId;\n  }\n\n  /**\n   * Remove all existing objects\n   */\n  removeAllObjects() {\n    let existingObjectIds = this.getExistingObjectIDs();\n\n    for (let index = existingObjectIds.size() - 1; index >= 0; index--) {\n      let objectId = existingObjectIds.get(index);\n      let object = this.getObjectFromScene(objectId);\n\n      this.removeObject(objectId);\n      if (window.config.dataset != \"objectnav\") {\n        this.sim.removeContactTestObject(object[\"objectHandle\"], 0);\n      }\n    }\n    this.sim.clearRecycledObjectIds();\n  }\n\n  /**\n   * Take one step in the simulation.\n   * @param {string} action - action to take\n   */\n  step(action, checkCollision = false) {\n    const agent = this.sim.getAgent(this.selectedAgentId);\n    if (checkCollision) {\n      let agentTransform = this.getAgentTransformation(this.selectedAgentId);\n      let data = this.isAgentColliding(action, agentTransform);\n      if (data[\"collision\"]) {\n        return true;\n      }\n    }\n    agent.act(action);\n    return false;\n  }\n\n  /**\n   * Add an agent to the simulation.\n   * @param {Object} config - agent config\n   */\n  addAgent(config) {\n    let agentConfig = this.createAgentConfig(config);\n    this.resolution = this.flipVec2i(\n      agentConfig.sensorSpecifications.get(0).resolution\n    );\n    return this.sim.addAgent(agentConfig);\n  }\n\n  /**\n   * Adds an instance of the specified object mesh to the environment.\n   * @param {number} objectLibIndex - index of the object's template\n   * @param {number} sceneId - specifies which physical scene to add an object to\n   * @returns {number} object ID or -1 if object was unable to be added\n   */\n  addObject(objectLibIndex) {\n    // using default values for rest of the params\n    return this.sim.addObject(objectLibIndex, null, \"\", 0);\n  }\n\n  /**\n   * Remove an instanced object by ID\n   * @param {number} objectID - index of the object's template\n   * @param {boolean} deleteObjectNode - if true, deletes the object's scene node\n   * @param {boolean} deleteVisualNode - if true, deletes the object's visual node\n   * @param {number} sceneId - specifies which physical scene to remove an object from\n   */\n  removeObject(objectId) {\n    // using default values for rest of the params\n    this.sim.removeObject(objectId, true, true, 0);\n  }\n\n  /**\n   * Adds an instance of the specified object mesh to the environment.\n   * @param {string} objectLibHandle - object's template config/origin handle\n   * @returns {number} object ID or -1 if object was unable to be added\n   */\n  addObjectByHandle(objectLibHandle) {\n    // using default values for rest of the params\n    return this.sim.addObjectByHandle(objectLibHandle, null, \"\", 0);\n  }\n\n  /**\n   * Add a random primitive object to the environment.\n   * @returns {number} object ID or -1 if object was unable to be added\n   */\n  addPrimitiveObject() {\n    let primitiveObjectIdx = getRandomInt(primitiveObjectHandles.length);\n    let objectLibHandle = primitiveObjectHandles[primitiveObjectIdx];\n    let objectId = this.addObjectByHandle(objectLibHandle);\n    let agentTransform = this.getAgentTransformation(0);\n    let position = agentTransform.transformPoint(\n      new Module.Vector3(0.1, 1.5, -1.5)\n    );\n    this.setTranslation(position, objectId, 0);\n    return objectId;\n  }\n\n  /**\n   * Add a random primitive object to the environment.\n   * @returns {number} object ID or -1 if object was unable to be added\n   */\n  removeLastObject() {\n    let existingObjectIds = this.getExistingObjectIDs();\n    if (existingObjectIds.size() > 0) {\n      this.removeObject(existingObjectIds.get(existingObjectIds.size() - 1));\n    }\n  }\n\n  /**\n   * Grab or release object under cross hair.\n   * @returns {number} object ID or -1 if object was unable to be added\n   */\n  grabReleaseObject() {\n    let nearestObjectId = this.getObjectUnderCrosshair();\n    let agentTransform = this.getAgentTransformation(0);\n\n    if (this.grippedObjectId != -1) {\n      // already gripped, so let it go\n      this.setTransformation(\n        agentTransform.mul(this.gripOffset),\n        this.grippedObjectId,\n        0\n      );\n\n      let position = this.getTranslation(this.grippedObjectId, 0);\n      let isNav = this.pathfinder.isNavigable(\n        this.convertVector3ToVec3f(position),\n        0.5\n      );\n      // check for collision (apparently this is always true)\n      if (!isNav) {\n        console.log(\"Colliding with object or position is not navigable\");\n        return;\n      }\n\n      this.setObjectMotionType(\n        Module.MotionType.STATIC,\n        this.grippedObjectId,\n        0\n      );\n      this.grippedObjectId = -1;\n      this.drawBBAroundNearestObject();\n    } else if (nearestObjectId != -1) {\n      this.gripOffset = agentTransform\n        .inverted()\n        .mul(this.getTransformation(nearestObjectId, 0));\n      this.setObjectMotionType(Module.MotionType.KINEMATIC, nearestObjectId, 0);\n      this.grippedObjectId = nearestObjectId;\n    } else {\n      return;\n    }\n\n    this.recomputeNavMesh();\n  }\n\n  /**\n   * Grab or release object under cross hair to inventory.\n   * @returns {number} object ID or -1 if object was unable to be added\n   */\n  inventoryGrabReleaseObject() {\n    let crossHairdata = this.getObjectUnderCrosshair();\n    let nearestObjectId = crossHairdata[\"nearestObjectId\"];\n    let grabAction = false;\n    let releaseAction = false;\n    let actionData = {};\n\n    if (this.grippedObjectId != -1) {\n      releaseAction = true;\n\n      let data = this.findObjectFloorPositionUnderCrosshair();\n      let newObjectPosition = data[\"newObjectPosition\"];\n      let invalidDropPoint = data[\"collision\"];\n\n      if (invalidDropPoint) {\n        return {\n          actionFailed: true\n        };\n      }\n      let object = this.getObjectFromScene(this.grippedObjectId);\n\n      // Drop object at collision free location\n      let newObjectId = this.addObjectByHandle(object[\"objectHandle\"]);\n      this.setTranslation(newObjectPosition, newObjectId, 0);\n      this.setObjectMotionType(Module.MotionType.DYNAMIC, newObjectId, 0);\n\n      this.updateObjectInScene(this.grippedObjectId, newObjectId);\n      // record action data\n      actionData = {\n        newObjectTranslation: this.convertVector3ToVec3f(newObjectPosition),\n        newObjectId: newObjectId,\n        objectHandle: object[\"objectHandle\"],\n        grippedObjectId: this.grippedObjectId\n      };\n\n      this.grippedObjectId = -1;\n    } else if (nearestObjectId != -1) {\n      grabAction = true;\n      this.grippedObjectTransformation = this.getTransformation(\n        nearestObjectId,\n        0\n      );\n      // Check if object is not a receptacle to grab\n      let object = this.getObjectFromScene(nearestObjectId);\n      if (object[\"isReceptacle\"] !== true) {\n        this.removeObject(nearestObjectId, 0);\n        this.grippedObjectId = nearestObjectId;\n      }\n      actionData = {\n        grippedObjectId: this.grippedObjectId\n      };\n    }\n\n    return {\n      grabAction: grabAction,\n      releaseAction: releaseAction,\n      objectUnderCrosshair: nearestObjectId,\n      grippedObjectId: this.grippedObjectId,\n      nearestObjectId: this.nearestObjectId,\n      actionMeta: actionData\n    };\n  }\n\n  /**\n   * Get the observation space for a given sensorId.\n   * @param {number} sensorId - id of sensor\n   * @returns {ObservationSpace} observation space of sensor\n   */\n  getObservationSpace(sensorId) {\n    return this.sim.getAgentObservationSpace(this.selectedAgentId, sensorId);\n  }\n\n  /**\n   * Get an observation from the given sensorId.\n   * @param {number} sensorId - id of sensor\n   * @param {Observation} obs - observation is read into this object\n   */\n  getObservation(sensorId, obs) {\n    this.sim.getAgentObservation(this.selectedAgentId, sensorId, obs);\n    return obs;\n  }\n\n  /**\n   * Get the PathFinder for the scene.\n   * @returns {PathFinder} pathFinder of the scene\n   */\n  getPathFinder() {\n    return this.sim.getPathFinder();\n  }\n\n  /**\n   * Get the motion type of an object.\n   * @param {number} objectID - object id identifying the object in sim.existingObjects_\n   * @param {number} sceneID - scene id\n   * @returns {MotionType} object MotionType or ERROR_MOTIONTYPE if query failed\n   */\n  getObjectMotionType(objectID, sceneID) {\n    return this.sim.getObjectMotionType(objectID, sceneID);\n  }\n\n  /**\n   * Set the motion type of an object.\n   * * @param {MotionType} motionType - desired motion type of the object\n   * @param {number} objectID - object id identifying the object in sim.existingObjects_\n   * @param {number} sceneID - scene id\n   * @returns {bool} object MotionType or ERROR_MOTIONTYPE if query failed\n   */\n  setObjectMotionType(motionType, objectID, sceneID) {\n    return this.sim.setObjectMotionType(motionType, objectID, sceneID);\n  }\n\n  /**\n   * Get the IDs of the physics objects instanced in a physical scene.\n   * @param {number} sceneID - scene id\n   * @returns {Array} list of existing object Ids in the scene\n   */\n  getExistingObjectIDs(sceneId = 0) {\n    return this.sim.getExistingObjectIDs(sceneId);\n  }\n\n  /**\n   * Set the 4x4 transformation matrix of an object kinematically.\n   * @param {Magnum::Matrix4} transform - desired 4x4 transform of the object.\n   * @param {number} objectID - object id identifying the object in sim.existingObjects_\n   * @param {number} sceneID - scene id\n   */\n  setTransformation(transform, objectID, sceneID) {\n    this.sim.setTransformation(transform, objectID, sceneID);\n  }\n\n  /**\n   * Get the current 4x4 transformation matrix of an object.\n   * @param {number} objectID - object id identifying the object in sim.existingObjects_\n   * @param {number} sceneID - scene id\n   * @returns {Magnum::Matrix4} 4x4 transform of the object\n   */\n  getTransformation(objectID, sceneID) {\n    return this.sim.getTransformation(objectID, sceneID);\n  }\n\n  /**\n   * Get the current 3D position of an object.\n   * @param {number} objectID - object id identifying the object in sim.existingObjects_\n   * @param {number} sceneID - scene id\n   * @returns {Magnum::Vector3} 3D position of the object\n   */\n  getTranslation(objectID, sceneID) {\n    return this.sim.getTranslation(objectID, sceneID);\n  }\n\n  /**\n   * Set the 3D position of an object kinematically.\n   * @param {Magnum::Vector3} translation - 3D position of the object\n   * @param {number} objectID - object id identifying the object in sim.existingObjects_\n   * @param {number} sceneID - scene id\n   */\n  setTranslation(translation, objectID, sceneID) {\n    this.sim.setTranslation(translation, objectID, sceneID);\n  }\n\n  /**\n   * Get the current orientation of an object.\n   * @param {number} objectID - object id identifying the object in sim.existingObjects_\n   * @param {number} sceneID - scene id\n   * @returns {Magnum::Vector3} quaternion representation of the object's orientation\n   */\n  getRotation(objectID, sceneID) {\n    return this.sim.getRotation(objectID, sceneID);\n  }\n\n  /**\n   * Set the orientation of an object kinematically.\n   * @param {Magnum::Vector3} rotation - desired orientation of the object\n   * @param {number} objectID - object id identifying the object in sim.existingObjects_\n   * @param {number} sceneID - scene id\n   */\n  setRotation(rotation, objectID, sceneID) {\n    this.sim.setRotation(rotation, objectID, sceneID);\n  }\n\n  /**\n   * Turn on/off rendering for the bounding box of the object's visual\n   * component.\n   * @param {boolean} drawBB - whether or not the render the bounding box\n   * @param {number} objectID - object id identifying the object in sim.existingObjects_\n   * @param {number} sceneID - scene id\n   */\n  setObjectBBDraw(drawBB, objectID, sceneID) {\n    this.sim.setObjectBBDraw(drawBB, objectID, sceneID);\n  }\n\n  /**\n   * @param {double} dt - step the physical world forward in time by a desired duration.\n   * @returns {double} world time after step\n   */\n  stepWorld(dt = 1.0 / 60.0) {\n    return this.sim.stepWorld(dt);\n  }\n\n  getWorldTime() {\n    return this.sim.getWorldTime();\n  }\n\n  /**\n   * Display an observation from the given sensorId\n   * to canvas selected as default frame buffer.\n   * @param {number} sensorId - id of sensor\n   */\n  displayObservation(sensorId) {\n    this.sim.displayObservation(0, sensorId);\n  }\n\n  /**\n   * Get the semantic scene.\n   * @returns {SemanticScene} semantic scene\n   */\n  getSemanticScene() {\n    return this.sim.getSemanticScene();\n  }\n\n  contactTest(objectId) {\n    return this.sim.contactTest(objectId, 0);\n  }\n\n  getAgent(agentId) {\n    return this.sim.getAgent(agentId);\n  }\n\n  getAgentTransformation(agentId) {\n    return this.sim.getAgentTransformation(agentId);\n  }\n\n  getAgentAbsoluteTranslation(agentId) {\n    return this.sim.getAgentAbsoluteTranslation(agentId);\n  }\n\n  getAgentRotation(agentId) {\n    return this.sim.getAgentRotation(agentId);\n  }\n\n  getAgentSensorSuite(agentId) {\n    return this.sim.getAgentSensorSuite(agentId);\n  }\n\n  getAgentState() {\n    let state = new Module.AgentState();\n    const agent = this.sim.getAgent(this.selectedAgentId);\n    agent.getState(state);\n    return state;\n  }\n\n  getCrosshairPosition() {\n    let center = this.resolution.map(function(element) {\n      return element * 0.5;\n    });\n    return center;\n  }\n\n  getObjectUnderCrosshair() {\n    let crossHairPosition = this.getCrosshairPosition();\n    let ray = this.unproject(crossHairPosition);\n    let crossHairPoint = ray.direction;\n    let refPoint = this.getAgentAbsoluteTranslation(0);\n\n    let nearestObjectId = this.findNearestObjectUnderCrosshair(\n      crossHairPoint,\n      refPoint,\n      this.resolution\n    );\n    return {\n      nearestObjectId: nearestObjectId,\n      crossHairPoint: this.convertVector3ToVec3f(crossHairPoint),\n      refPoint: this.convertVector3ToVec3f(refPoint),\n      crossHairPosition: crossHairPosition\n    };\n  }\n\n  drawBBAroundNearestObject() {\n    let objectId = this.getObjectUnderCrosshair()[\"nearestObjectId\"];\n    if (objectId == -1) {\n      if (\n        this.nearestObjectId != -1 &&\n        this.grippedObjectId != this.nearestObjectId\n      ) {\n        this.setObjectBBDraw(false, this.nearestObjectId, 0);\n        this.nearestObjectId = objectId;\n      }\n    } else {\n      if (\n        this.nearestObjectId != -1 &&\n        this.grippedObjectId != this.nearestObjectId\n      ) {\n        this.setObjectBBDraw(false, this.nearestObjectId, 0);\n        this.nearestObjectId = -1;\n      }\n      // Don't draw bb around receptacles\n      let object = this.getObjectFromScene(objectId);\n      if (object[\"isReceptacle\"] === true) {\n        return;\n      }\n      if (this.nearestObjectId != objectId) {\n        this.nearestObjectId = objectId;\n        this.setObjectBBDraw(true, this.nearestObjectId, 0);\n      }\n    }\n  }\n\n  showDropPoint() {\n    if (this.grippedObjectId === -1) {\n      let position = this.getAgentAbsoluteTranslation(0);\n      position = new Module.Vector3(\n        position.x(),\n        position.y() - 0.5,\n        position.z()\n      );\n      this.updateDropPointNode(position);\n    } else {\n      let data = this.findObjectFloorPositionUnderCrosshair();\n      let newObjectPosition = data[\"newObjectPosition\"];\n      this.updateDropPointNode(newObjectPosition);\n    }\n  }\n\n  updateDropPointNode(position) {\n    this.sim.updateDropPointNode(position);\n  }\n\n  findObjectFloorPositionUnderCrosshair() {\n    // Object already gripped, so let it go\n    let crossHairPosition = this.getCrosshairPosition();\n    let ray = this.unproject(crossHairPosition);\n    let crossHairPoint = ray.direction;\n    let refTransform = this.getAgentTransformation(0);\n\n    // Get raycast hit point\n    let rayHitInfo = this.sim.findFloorPositionUnderCrosshair(\n      crossHairPoint,\n      refTransform,\n      this.resolution,\n      this.maxDistance\n    );\n    let floorPosition = rayHitInfo.point;\n    if (floorPosition == null) {\n      return true;\n    }\n\n    // use original Y value to keep object on the floor if crosshair is pointing on ground\n    let newObjectPosition = new Module.Vector3(\n      floorPosition.x(),\n      floorPosition.y(),\n      floorPosition.z()\n    );\n\n    let object = this.getObjectFromScene(this.grippedObjectId);\n\n    // Collision check on drop point\n    let collision = this.isCollision(object[\"objectHandle\"], newObjectPosition);\n    let count = 0;\n    while (collision && count < 2) {\n      newObjectPosition = new Module.Vector3(\n        newObjectPosition.x(),\n        newObjectPosition.y() + 0.25,\n        newObjectPosition.z()\n      );\n      collision = this.isCollision(object[\"objectHandle\"], newObjectPosition);\n      count += 1;\n    }\n    let snappedPoint = this.pathfinder.snapPoint(newObjectPosition);\n    snappedPoint = this.convertVector3ToVec3f(snappedPoint);\n    let isOnSeparateIsland =\n      this.pathfinder.islandRadius(snappedPoint) < this.islandRadiusLimit;\n\n    let y_diff = Math.abs(\n      refTransform.translation().y() - newObjectPosition.y()\n    );\n    let isDroppedOnIncorrectFloor = y_diff > 1.6;\n    return {\n      newObjectPosition: newObjectPosition,\n      collision: collision || isOnSeparateIsland || isDroppedOnIncorrectFloor\n    };\n  }\n\n  sampleObjectState(objectID, sceneID) {\n    this.sim.sampleObjectState(objectID, sceneID);\n  }\n\n  recomputeNavMesh() {\n    let navMeshSettings = new Module.NavMeshSettings();\n    navMeshSettings.agentRadius = defaultAgentConfig.radius;\n    navMeshSettings.agentHeight = defaultAgentConfig.height;\n    this.sim.recomputeNavMesh(this.getPathFinder(), navMeshSettings, true);\n  }\n\n  toggleNavMeshVisualization() {\n    this.sim.setNavMeshVisualization(true);\n  }\n\n  findNearestObjectUnderCrosshair(crossHairPoint, refPoint, windowSize) {\n    return this.sim.findNearestObjectUnderCrosshair(\n      crossHairPoint,\n      refPoint,\n      windowSize,\n      this.maxDistance\n    );\n  }\n\n  unproject(crossHairPosition) {\n    return this.sim.unproject(crossHairPosition);\n  }\n\n  isAgentColliding(action, agentTransform) {\n    let stepSize = 0.15;\n    if (action == \"moveForward\") {\n      let position = agentTransform.backward().mul(-1 * stepSize);\n      let newPosition = agentTransform.translation().add(position);\n      let filteredPoint = this.pathfinder.tryStep(\n        agentTransform.translation(),\n        newPosition\n      );\n      let filterDiff = filteredPoint.sub(newPosition);\n      // adding buffer of 0.1 y to avoid collision with navmesh\n      let isColliding = false;\n      let offsets = [0, 0.05, -0.05, 0.1, -0.1, -0.2];\n      for (let idx in offsets) {\n        let offset = offsets[idx];\n        let finalPosition = newPosition\n          .add(filterDiff)\n          .add(new Module.Vector3(0.0, offset, 0.0));\n        let collision = this.isCollision(\n          this.agentObjectHandle,\n          finalPosition,\n          true\n        );\n        if (collision) {\n          isColliding = true;\n        }\n      }\n      return {\n        collision: isColliding\n      };\n    } else if (action == \"moveBackward\") {\n      let position = agentTransform.backward().mul(stepSize);\n      let newPosition = agentTransform.translation().add(position);\n      let filteredPoint = this.pathfinder.tryStep(\n        agentTransform.translation(),\n        newPosition\n      );\n      let filterDiff = filteredPoint.sub(newPosition);\n      // adding buffer of 0.1 y to avoid collision with navmesh\n      let isColliding = false;\n      let offsets = [0, 0.05, -0.05, 0.1, -0.1, -0.2];\n      for (let idx in offsets) {\n        let offset = offsets[idx];\n        let finalPosition = newPosition\n          .add(filterDiff)\n          .add(new Module.Vector3(0.0, offset, 0.0));\n        let collision = this.isCollision(\n          this.agentObjectHandle,\n          finalPosition,\n          true\n        );\n        if (collision) {\n          isColliding = true;\n        }\n      }\n      return {\n        collision: isColliding\n      };\n    }\n    return false;\n  }\n\n  isCollision(objectHandle, point, isNavigationTest = false, sceneId = 0) {\n    let collisionGroup = 1;\n    let collisionMask = -1;\n    if (isNavigationTest) {\n      collisionMask = 1;\n    }\n    return this.sim.preAddContactTest(\n      objectHandle,\n      point,\n      isNavigationTest,\n      collisionGroup,\n      collisionMask,\n      sceneId\n    );\n  }\n\n  /**\n   * Get the geodesic distance between two points.\n   * @param {number} positionA - starting position\n   * @param {number} positionB - ending position\n   * @returns {number} distance between positionA and positionB\n   */\n  geodesicDistance(positionA, positionB) {\n    let path = new Module.ShortestPath();\n    path.requestedStart = positionA;\n    path.requestedEnd = positionB;\n    this.pathfinder.findPath(path);\n    return path.geodesicDistance;\n  }\n\n  /**\n   * Get the geodesic distance between two objects.\n   * @param {number} sourceObjectId - source object id\n   * @param {number} destinationObjectId - destination object id\n   * @returns {number} distance between sourceObjectId and destinationObjectId\n   */\n  getDistanceBetweenObjects(sourceObjectId, destinationObjectId) {\n    let sourcePosition = this.getTranslation(sourceObjectId, 0);\n    let destinationPosition = this.getTranslation(destinationObjectId, 0);\n\n    let distance = this.geodesicDistance(\n      this.convertVector3ToVec3f(sourcePosition),\n      this.convertVector3ToVec3f(destinationPosition)\n    );\n    return distance;\n  }\n\n  getObjectBBYCoord(objectId) {\n    return this.sim.getObjectBBYCoord(objectId);\n  }\n\n  getNumActiveContactPoints() {\n    return this.sim.getNumActiveContactPoints();\n  }\n\n  getSceneBB() {\n    return this.sim.getSceneBB();\n  }\n\n  getObjectStates() {\n    let objectStates = [];\n    let existingObjectIds = this.getExistingObjectIDs();\n\n    for (let index = 0; index < existingObjectIds.size(); index++) {\n      let objectId = existingObjectIds.get(index);\n      let translation = this.getTranslation(objectId, 0);\n      let rotation = this.getRotation(objectId, 0);\n      let motionType = this.getObjectMotionType(objectId, 0).value;\n      let object = this.getObjectFromScene(objectId);\n      let objectState = {\n        objectId: objectId,\n        translation: this.convertVector3ToVec3f(translation),\n        rotation: this.coeffFromQuat(rotation),\n        motionType: motionType,\n        objectHandle: object[\"objectHandle\"]\n      };\n      objectStates.push(objectState);\n    }\n\n    return objectStates;\n  }\n\n  getAgentPose() {\n    let tfms = this.getAgentTransformation(this.selectedAgentId);\n    let agentPosition = tfms.translation();\n    let agentRotation = this.getAgentRotation(this.selectedAgentId);\n    let sensors = this.getAgentSensorSuite(this.selectedAgentId);\n    let sensorKeys = sensors.keys();\n    let sensorData = {};\n    for (let i = 0; i < sensorKeys.size(); i++) {\n      let key = sensorKeys.get(i);\n      let rotation = sensors.get(key).rotation();\n      let position = sensors.get(key).translation();\n      sensorData[key] = {\n        rotation: this.coeffFromQuat(rotation),\n        position: this.convertVector3ToVec3f(position)\n      };\n    }\n    return {\n      position: this.convertVector3ToVec3f(agentPosition),\n      rotation: this.coeffFromQuat(agentRotation),\n      sensorData: sensorData\n    };\n  }\n\n  convertVector3ToVec3f(position) {\n    let vec3fPosition = [position.x(), position.y(), position.z()];\n    return vec3fPosition;\n  }\n\n  convertVec3fToVector3(position) {\n    let vector3Position = new Module.Vector3(\n      position[0],\n      position[1],\n      position[2]\n    );\n    return vector3Position;\n  }\n\n  coeffFromQuat(rotation) {\n    let vector = this.convertVector3ToVec3f(rotation.vector());\n    let coeff = vector.slice();\n    coeff.push(rotation.scalar());\n    return coeff;\n  }\n\n  quatFromCoeffs(rotation) {\n    let vector = this.convertVec3fToVector3(rotation.slice(0, 3));\n    let quatRotation = new Module.Quaternion(vector, rotation[3]);\n    return quatRotation;\n  }\n\n  flipVec2i(position) {\n    return [position[1], position[0]];\n  }\n\n  euclideanDistance(positionA, positionB) {\n    return Math.sqrt(\n      (positionA[0] - positionB[0]) ** 2 +\n        (positionA[2] - positionB[2]) ** 2 +\n        (positionA[1] - positionB[1]) ** 2\n    );\n  }\n\n  enableDebugDraw() {\n    this.sim.enableDebugDraw();\n  }\n\n  /**\n   * Get the distance to goal in polar coordinates.\n   * @returns {Array} [magnitude, clockwise-angle (in radians)]\n   */\n  distanceToGoal() {\n    if (\n      Object.keys(this.episode).length === 0 ||\n      this.episode.goal === undefined\n    ) {\n      return [0, 0];\n    }\n    let dst = this.episode.goal.position;\n    let state = this.getAgentState();\n    let src = state.position;\n    let dv = [dst[0] - src[0], dst[1] - src[1], dst[2] - src[2]];\n    dv = this.applyRotation(dv, state.rotation);\n    return this.cartesian_to_polar(-dv[2], dv[0]);\n  }\n\n  // PRIVATE methods.\n\n  // Rotate vector, v, by quaternion, q.\n  // Result r = q' * v * q where q' is the quaternion conjugate.\n  // http://www.chrobotics.com/library/understanding-quaternions\n  applyRotation(v, q) {\n    let x, y, z;\n    [x, y, z] = v;\n    let qx, qy, qz, qw;\n    [qx, qy, qz, qw] = q;\n\n    // i = q' * v\n    let ix = qw * x - qy * z + qz * y;\n    let iy = qw * y - qz * x + qx * z;\n    let iz = qw * z - qx * y + qy * x;\n    let iw = qx * x + qy * y + qz * z;\n\n    // r = i * q\n    let r = [];\n    r[0] = ix * qw + iw * qx + iy * qz - iz * qy;\n    r[1] = iy * qw + iw * qy + iz * qx - ix * qz;\n    r[2] = iz * qw + iw * qz + ix * qy - iy * qx;\n\n    return r;\n  }\n\n  cartesian_to_polar(x, y) {\n    return [Math.sqrt(x * x + y * y), Math.atan2(y, x)];\n  }\n\n  createSensorSpec(config) {\n    const converted = new Module.SensorSpec();\n    for (let key in config) {\n      let value = config[key];\n      converted[key] = value;\n    }\n    return converted;\n  }\n\n  createAgentConfig(config) {\n    const converted = new Module.AgentConfiguration();\n    for (let key in config) {\n      let value = config[key];\n      if (key === \"sensorSpecifications\") {\n        const sensorSpecs = new Module.VectorSensorSpec();\n        for (let c of value) {\n          sensorSpecs.push_back(this.createSensorSpec(c));\n        }\n        value = sensorSpecs;\n      }\n      converted[key] = value;\n    }\n    return converted;\n  }\n\n  createAgentState(state) {\n    const converted = new Module.AgentState();\n    for (let key in state) {\n      let value = state[key];\n      converted[key] = value;\n    }\n    return converted;\n  }\n}\n\nexport default SimEnv;\n","// Copyright (c) Facebook, Inc. and its affiliates.\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\n/**\n * TaskValidator class\n */\nclass TaskValidator {\n  // PUBLIC methods.\n\n  /**\n   * Create task validator.\n   * @param {object} episode - task config\n   */\n  constructor(episode, sim) {\n    this.episode = episode;\n    this.sim = sim;\n    this.task = this.episode.task;\n  }\n\n  validate() {\n    if (this.task === undefined) {\n      return true;\n    }\n    if (this.task.type === \"arrangement\") {\n      return this.validateArrangementTask();\n    } else if (this.task.type === \"cleaning\") {\n      return this.validateCleaningTask();\n    } else if (this.task.type == \"objectnav\") {\n      if (this.episode.is_thda == true) {\n        return this.validateObjectNavTHDATask();\n      }\n      return this.validateObjectNavTask();\n    }\n  }\n\n  validateArrangementTask() {\n    let goal = this.task.goals;\n    if (goal === undefined || goal.objectToReceptacleMap === undefined) {\n      return true;\n    }\n\n    if (this.sim.grippedObjectId != -1) {\n      return false;\n    }\n\n    let objectToGoalMap = goal.objectToReceptacleMap;\n    let objectsInScene = this.sim.getObjectsInScene();\n    let episode = this.sim.episode;\n    let taskStarted = false;\n\n    // Check if objects have moved from the initial position\n    let objectsInitialState = episode.objects;\n    for (let index in objectsInitialState) {\n      let objectId = objectsInitialState[index][\"objectId\"];\n      let objectInitialTranslation = objectsInitialState[index][\"position\"];\n      let objectTranslation = this.sim.convertVector3ToVec3f(\n        this.sim.getTranslation(objectId, 0)\n      );\n\n      let distance = this.sim.geodesicDistance(\n        objectInitialTranslation,\n        objectTranslation\n      );\n      if (distance > 0) {\n        taskStarted = true;\n      }\n    }\n\n    for (let key in objectToGoalMap) {\n      let sourceObjectId = objectsInScene[parseInt(key)][\"objectId\"];\n      let sourcePosition = this.sim.convertVector3ToVec3f(\n        this.sim.getTranslation(sourceObjectId, 0)\n      );\n      let receptacles = objectToGoalMap[key];\n\n      let success = false;\n      for (let i = 0; i < receptacles.length; i++) {\n        let receptacleObjectId = objectsInScene[receptacles[i]][\"objectId\"];\n        let receptaclePosition = this.sim.convertVector3ToVec3f(\n          this.sim.getTranslation(receptacleObjectId, 0)\n        );\n\n        let distance = this.sim.geodesicDistance(\n          sourcePosition,\n          receptaclePosition\n        );\n        let receptacleY =\n          receptaclePosition[1] +\n          this.sim.getObjectBBYCoord(receptacleObjectId);\n        if (distance <= 0.7 && sourcePosition[1] > receptacleY) {\n          success = true;\n        }\n      }\n      if (!success) {\n        return false;\n      }\n    }\n    return true && taskStarted;\n  }\n\n  validateObjectNavTask() {\n    let goals = this.episode.goals;\n    if (goals === undefined) {\n      return true;\n    }\n\n    let taskSuccess = false;\n    for (let goal in goals) {\n      let objectGoal = this.episode.goals[goal];\n\n      for (let viewPointt in objectGoal.view_points) {\n        let viewPoint = objectGoal.view_points[viewPointt];\n        let position = viewPoint.agent_state.position;\n\n        let agentTransform = this.sim.getAgentTransformation(\n          this.sim.selectedAgentId\n        );\n        let agentPosition = this.sim.convertVector3ToVec3f(\n          agentTransform.translation()\n        );\n\n        let dist = this.sim.geodesicDistance(agentPosition, position);\n        //let euDist = this.sim.euclideanDistance(agentPosition, position);\n\n        if (dist < 0.1) {\n          taskSuccess = true;\n        }\n      }\n    }\n    return taskSuccess;\n  }\n\n  validateObjectNavTHDATask() {\n    let goals = this.episode.goals;\n    if (goals === undefined) {\n      return true;\n    }\n\n    let taskSuccess = false;\n    for (let goal in goals) {\n      let objectGoal = this.episode.goals[goal];\n      // THDA uses goal object center\n      // for (let viewPointt in objectGoal.view_points) {\n      // let viewPoint = objectGoal.view_points[viewPointt];\n      let position = objectGoal.position;\n\n      let agentTransform = this.sim.getAgentTransformation(\n        this.sim.selectedAgentId\n      );\n      let agentPosition = this.sim.convertVector3ToVec3f(\n        agentTransform.translation()\n      );\n\n      // let dist = this.sim.geodesicDistance(agentPosition, position);\n      // THDA uses Euclidean distance\n      let euDist = this.sim.euclideanDistance(agentPosition, position);\n      if (euDist < 1.0) {\n        taskSuccess = true;\n      }\n    }\n    return taskSuccess;\n  }\n\n  validateCleaningTask() {\n    let goal = this.task.goals;\n    if (goal === undefined) {\n      return true;\n    }\n\n    if (this.sim.grippedObjectId != -1) {\n      return false;\n    }\n\n    let episode = this.sim.episode;\n    let taskStarted = false;\n    let lifted = 0;\n    let numObjectsMoved = 0;\n\n    // Check if objects have moved from the initial position\n    let objectsInitialState = episode.objects;\n    for (let index in objectsInitialState) {\n      let objectId = objectsInitialState[index][\"objectId\"];\n      let objectInitialTranslation = objectsInitialState[index][\"position\"];\n      let objectTranslation = this.sim.convertVector3ToVec3f(\n        this.sim.getTranslation(objectId, 0)\n      );\n\n      let distance = this.sim.geodesicDistance(\n        objectInitialTranslation,\n        objectTranslation\n      );\n\n      if (distance > 0.2) {\n        taskStarted = true;\n        numObjectsMoved += 1;\n      }\n      let y_diff = Math.abs(objectInitialTranslation[1] - objectTranslation[1]);\n      if (y_diff > 0.2) {\n        lifted += 1;\n      }\n    }\n    console.log(\n      \"Num moved: \" +\n        numObjectsMoved +\n        \" lifted: \" +\n        lifted +\n        \"  --- \" +\n        taskStarted\n    );\n    return (numObjectsMoved >= 4 || lifted >= 4) && taskStarted;\n  }\n}\n\nexport default TaskValidator;\n","// Copyright (c) Facebook, Inc. and its affiliates.\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\nimport PsiturkEventLogger from \"./event_logger\";\nimport TaskValidator from \"./task_validator\";\n\n/**\n * ObjectNavTask class\n */\nclass ObjectNavTask {\n  // PUBLIC methods.\n\n  /**\n   * Create navigate task.\n   * @param {SimEnv} sim - simulator\n   * @param {Object} components - dictionary with status and canvas elements\n   */\n  constructor(sim, components) {\n    this.sim = sim;\n    this.components = components;\n    this.keyBindListener = null;\n    this.taskValidator = null;\n\n    if (this.components.taskValidator) {\n      this.taskValidator = this.components.taskValidator;\n    }\n\n    this.psiturk = new PsiturkEventLogger(window.psiTurk);\n\n    this.actions = [\n      { name: \"moveForward\", key: \"w\", keyCode: 87 },\n      { name: \"turnLeft\", key: \"ArrowLeft\", keyCode: 37 },\n      { name: \"turnRight\", key: \"ArrowRight\", keyCode: 39 },\n      { name: \"turnLeft\", key: \"a\", keyCode: 65 },\n      { name: \"turnRight\", key: \"d\", keyCode: 68 },\n      { name: \"lookUp\", key: \"ArrowUp\", keyCode: 38 },\n      { name: \"lookDown\", key: \"ArrowDown\", keyCode: 40 }\n    ];\n  }\n\n  /**\n   * Initialize the task. Should be called once.\n   */\n  init() {\n    this.bindKeys();\n    this.psiturk.handleRecordTrialData(\"TEST\", \"simInitialized\", {\n      config: window.config\n    });\n    this.initialized = true;\n    this.initRendering();\n  }\n\n  initRendering() {\n    this.activeActions = [];\n    this.activeActionIdx = 0;\n    this.frameCounter = 0;\n    this.frameRate = 7.0;\n    if (window.config.runFlythrough !== true) {\n      console.log(\"enabled rendering step at 100ms interval\");\n      this.renderingFunction = setInterval(() => {\n        let action = this.popAction();\n\n        // Step action from the queue\n        this.handleAction(action);\n\n        // Render observation\n        this.render();\n        this.frameCounter += 1;\n      }, 1000.0 / this.frameRate);\n    }\n  }\n\n  disableRendering() {\n    if (this.renderingFunction) {\n      console.log(\"clearing rendering interval on reset\");\n      window.clearInterval(this.renderingFunction);\n    }\n  }\n\n  /**\n   * Reset the task.\n   */\n  reset() {\n    this.disableRendering();\n    this.sim.reset();\n    this.setStatus(\"Ready\");\n    this.initRendering();\n    this.render();\n  }\n\n  setTaskValidator(epsiode) {\n    this.taskValidator = new TaskValidator(epsiode, this.sim);\n  }\n\n  // PRIVATE methods.\n\n  setStatus(text) {\n    this.components.status.style = \"color:white\";\n    this.components.status.innerHTML = text;\n  }\n\n  setErrorStatus(text) {\n    this.components.status.style = \"color:red\";\n    this.components.status.innerHTML = text;\n  }\n\n  setWarningStatus(text) {\n    this.components.status.style = \"color:orange\";\n    this.components.status.innerHTML = text;\n  }\n\n  setSuccessStatus(text) {\n    this.components.status.style = \"color:green\";\n    this.components.status.innerHTML = text;\n  }\n\n  renderImage() {\n    this.sim.displayObservation(\"rgb\");\n  }\n\n  render() {\n    this.renderImage();\n    this.renderImage();\n  }\n\n  validateTask() {\n    if (window.config.runFlythrough) {\n      return false;\n    }\n    return this.taskValidator.validate();\n  }\n\n  pushAction(action) {\n    if (this.activeActions.length == 0) {\n      this.activeActions.push(action);\n    }\n  }\n\n  popAction() {\n    if (this.activeActions.length > 0) {\n      this.activeActionIdx = 0;\n      let action = this.activeActions[this.activeActionIdx];\n      return action;\n    }\n    return \"noOp\";\n  }\n\n  handleAction(action) {\n    let collision = this.sim.step(action);\n    // Log action and agent state\n    let agentState = this.sim.getAgentPose();\n    let logData = {\n      action: action,\n      agentState: agentState,\n      collision: collision\n    };\n    this.psiturk.handleRecordTrialData(\"TEST\", \"handleAction\", logData);\n  }\n\n  removeActiveAction(action) {\n    const index = this.activeActions.indexOf(action);\n    if (index > -1) {\n      this.activeActions.splice(index, 1);\n    }\n  }\n\n  handleKeypressUp(key) {\n    for (let a of this.actions) {\n      if (a.keyCode === key) {\n        this.removeActiveAction(a.name);\n        break;\n      }\n    }\n  }\n\n  handleKeypress(key) {\n    for (let a of this.actions) {\n      if (a.keyCode === key) {\n        this.pushAction(a.name);\n        break;\n      }\n    }\n  }\n\n  bindKeys() {\n    var _self = this;\n    if (_self.keyBindListener) {\n      console.log(\"Keys already bound. Returning\");\n      return;\n    }\n    _self.keyBindListener = function(event) {\n      event.preventDefault();\n      _self.handleKeypress(event.keyCode);\n    };\n    document.addEventListener(\"keydown\", _self.keyBindListener, true);\n\n    _self.keyBindListener2 = function(event) {\n      event.preventDefault();\n      _self.handleKeypressUp(event.keyCode);\n    };\n    document.addEventListener(\"keyup\", _self.keyBindListener2, true);\n  }\n\n  unbindKeys() {\n    if (this.keyBindListener) {\n      document.removeEventListener(\"keydown\", this.keyBindListener, true);\n      this.keyBindListener = null;\n\n      document.removeEventListener(\"keyup\", this.keyBindListener2, true);\n      this.keyBindListener2 = null;\n    }\n  }\n}\n\nexport default ObjectNavTask;\n","// Copyright (c) Facebook, Inc. and its affiliates.\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\n/**\n * Inventory class\n */\nclass Inventory {\n  // PUBLIC methods.\n\n  /**\n   * Create inverntory.\n   * @param {number} inventorySlots - inventory size\n   */\n  constructor(inventorySlots) {\n    this.inventorySlots = inventorySlots;\n    this.inventory = new Array(inventorySlots);\n    this.inventoryComponent = null;\n    this.inventoryEnabled = false;\n    this.inventoryCtx = null;\n  }\n\n  reset() {\n    this.inventory = new Array(this.inventorySlots);\n  }\n\n  initInventory(component) {\n    this.inventoryComponent = component;\n    this.inventoryEnabled = true;\n    this.inventoryCtx = component.getContext(\"2d\");\n  }\n\n  setSlot(index, value) {\n    this.inventory[index] = value;\n  }\n\n  getSlot(index) {\n    return this.inventory[index];\n  }\n\n  getEmptySlot() {\n    for (let index = 0; index < this.inventorySlots; index++) {\n      if (this.inventory[index] === undefined) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  findObjectSlot(objectId) {\n    for (let index = 0; index < this.inventorySlots; index++) {\n      if (\n        this.inventory[index] !== undefined &&\n        this.inventory[index][\"objectId\"] === objectId\n      ) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  renderInventory() {\n    if (!this.inventoryEnabled) {\n      return;\n    }\n\n    const height = 80;\n    const padding = 2;\n    const width = height * this.inventorySlots;\n\n    if (this.inventoryComponent.style.border === \"\") {\n      this.inventoryComponent.style.border = \"5px solid #000000\";\n      this.inventoryComponent.width = width.toString();\n    }\n\n    let ctx = this.inventoryCtx;\n    ctx.clearRect(0, 0, width, height);\n    ctx.fillStyle = \"darkslategray\";\n    const boxSize = height - padding * 2;\n    for (let i = 0; i < this.inventorySlots; ++i) {\n      // draw box\n      const boxOffset = padding + i * (boxSize + padding);\n      ctx.beginPath();\n      ctx.strokeStyle = \"grey\";\n      ctx.lineWidth = 5;\n      ctx.rect(boxOffset, padding, boxSize, boxSize);\n      ctx.stroke();\n      ctx.closePath();\n\n      const imgSize = boxSize - padding * 2;\n      if (this.inventory[i] !== undefined) {\n        let img = new Image();\n        img.src = this.inventory[i][\"objectIcon\"];\n        img.addEventListener(\"load\", () => {\n          ctx.drawImage(\n            img,\n            boxOffset + padding,\n            padding * 2,\n            imgSize,\n            imgSize\n          );\n        });\n      }\n    }\n  }\n}\n\nexport default Inventory;\n","// Copyright (c) Facebook, Inc. and its affiliates.\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\n/* global Module */\n\nimport PsiturkEventLogger from \"./event_logger\";\nimport { inventorySlots } from \"./defaults\";\nimport Inventory from \"./inventory\";\nimport TaskValidator from \"./task_validator\";\n\n/**\n * PickPlaceTask class\n */\nclass PickPlaceTask {\n  // PUBLIC methods.\n\n  /**\n   * Create navigate task.\n   * @param {SimEnv} sim - simulator\n   * @param {Object} components - dictionary with status and canvas elements\n   */\n  constructor(sim, components) {\n    this.sim = sim;\n    this.components = components;\n    this.keyBindListener = null;\n    this.lastInteractedObjectId = -1;\n    this.inventory = new Inventory(inventorySlots);\n    this.taskValidator = null;\n\n    this.inventory.initInventory(components.inventory);\n\n    if (this.components.taskValidator) {\n      this.taskValidator = this.components.taskValidator;\n    }\n\n    this.psiturk = new PsiturkEventLogger(window.psiTurk);\n\n    this.actions = [\n      { name: \"moveForward\", key: \"w\", keyCode: 87 },\n      { name: \"moveBackward\", key: \"s\", keyCode: 83 },\n      { name: \"turnLeft\", key: \"ArrowLeft\", keyCode: 37 },\n      { name: \"turnRight\", key: \"ArrowRight\", keyCode: 39 },\n      { name: \"turnLeft\", key: \"a\", keyCode: 65 },\n      { name: \"turnRight\", key: \"d\", keyCode: 68 },\n      { name: \"lookUp\", key: \"ArrowUp\", keyCode: 38 },\n      { name: \"lookDown\", key: \"ArrowDown\", keyCode: 40 },\n      { name: \"grabReleaseObject\", key: \" \", keyCode: 32 }\n    ];\n  }\n\n  /**\n   * Initialize the task. Should be called once.\n   */\n  init() {\n    this.bindKeys();\n    this.psiturk.handleRecordTrialData(\"TEST\", \"simInitialized\", {\n      config: window.config\n    });\n    this.initialized = true;\n    this.initPhysics();\n  }\n\n  initPhysics() {\n    this.activeActions = [];\n    this.activeActionIdx = 0;\n    this.frameCounter = 0;\n    this.numRendersSinceLastUpdate = 0;\n    this.frameCounter = 0;\n    this.frameRate = 20.0;\n    if (Module.enablePhysics && window.config.runFlythrough !== true) {\n      console.log(\"enabled physics step at 100ms interval\");\n      this.physicsStepFunction = setInterval(() => {\n        let action = this.popAction();\n        if (action != \"noOp\") {\n          // step action from the queue\n          this.handleAction(action);\n        }\n        let stepSize = 1.0 / this.frameRate;\n        let startTime = new Date().getTime();\n        // Step world physics\n        this.sim.stepWorld(stepSize);\n        // Render observation\n        this.render();\n\n        // Log current state for replay\n        let agentState = this.sim.getAgentPose();\n        let objectStates = this.sim.getObjectStates();\n        let objectUnderCrosshair = this.sim.getObjectUnderCrosshair()[\n          \"nearestObjectId\"\n        ];\n        let objectDropPoint = [];\n        if (this.sim.grippedObjectId != -1) {\n          objectDropPoint = this.sim.findObjectFloorPositionUnderCrosshair()[\n            \"newObjectPosition\"\n          ];\n          objectDropPoint = this.sim.convertVector3ToVec3f(objectDropPoint);\n        }\n        this.psiturk.handleRecordTrialData(\"TEST\", \"stepPhysics\", {\n          step: stepSize,\n          agentState: agentState,\n          objectStates: objectStates,\n          objectUnderCrosshair: objectUnderCrosshair,\n          objectDropPoint: objectDropPoint,\n          totalTime: new Date().getTime() - startTime\n        });\n        this.frameCounter += 1;\n      }, 1000.0 / this.frameRate);\n    }\n  }\n\n  disablePhysics() {\n    if (this.physicsStepFunction) {\n      console.log(\"clearing physics interval on reset\");\n      window.clearInterval(this.physicsStepFunction);\n    }\n  }\n\n  /**\n   * Reset the task.\n   */\n  reset() {\n    this.lastInteractedObjectId = -1;\n    this.disablePhysics();\n    this.sim.reset();\n    this.inventory.reset();\n    this.inventory.renderInventory();\n    this.setStatus(\"Ready\");\n    this.initPhysics();\n    this.render();\n  }\n\n  setTaskValidator(epsiode) {\n    this.taskValidator = new TaskValidator(epsiode, this.sim);\n  }\n\n  // PRIVATE methods.\n\n  setStatus(text) {\n    this.components.status.style = \"color:white\";\n    this.components.status.innerHTML = text;\n  }\n\n  setErrorStatus(text) {\n    this.components.status.style = \"color:red\";\n    this.components.status.innerHTML = text;\n  }\n\n  setWarningStatus(text) {\n    this.components.status.style = \"color:orange\";\n    this.components.status.innerHTML = text;\n  }\n\n  setSuccessStatus(text) {\n    this.components.status.style = \"color:green\";\n    this.components.status.innerHTML = text;\n  }\n\n  renderImage() {\n    this.sim.displayObservation(\"rgb\");\n  }\n\n  render() {\n    this.renderImage();\n\n    this.sim.updateCrossHairNode(this.sim.getCrosshairPosition());\n    this.sim.drawBBAroundNearestObject();\n    this.sim.showDropPoint();\n\n    this.renderImage();\n\n    this.numRendersSinceLastUpdate += 1;\n  }\n\n  handleInventoryUpdate(isCollision) {\n    let objectId = this.sim.grippedObjectId;\n    if (isCollision) {\n      this.setStatus(\"Collision while releasing object!\");\n      return;\n    }\n    if (objectId == -1) {\n      let slot = this.inventory.findObjectSlot(this.lastInteractedObjectId);\n      if (slot != -1) {\n        this.inventory.setSlot(slot, undefined);\n      }\n    } else {\n      let emptySlot = this.inventory.getEmptySlot();\n      let object = this.sim.getObjectFromScene(objectId);\n\n      if (emptySlot == -1) {\n        console.log(\"No empty slot in inventory!\");\n      } else {\n        this.inventory.setSlot(emptySlot, {\n          objectId: objectId,\n          object: object[\"object\"],\n          objectIcon: object[\"objectIcon\"]\n        });\n      }\n    }\n    this.lastInteractedObjectId = objectId;\n  }\n\n  validateTask() {\n    if (window.config.runFlythrough) {\n      return false;\n    }\n    return this.taskValidator.validate();\n  }\n\n  pushAction(action) {\n    if (this.activeActions.length == 0) {\n      this.activeActions.push(action);\n    }\n  }\n\n  popAction() {\n    if (this.activeActions.length > 0) {\n      this.activeActionIdx = 0;\n      let action = this.activeActions[this.activeActionIdx];\n      if (action == \"grabReleaseObject\") {\n        this.removeActiveAction(action);\n      }\n      return action;\n    }\n    return \"noOp\";\n  }\n\n  handleAction(action) {\n    let actionData = {};\n    let collision = false;\n    if (action == \"grabReleaseObject\") {\n      let data = this.sim.inventoryGrabReleaseObject();\n      this.handleInventoryUpdate(data[\"collision\"]);\n      this.inventory.renderInventory();\n      actionData = data;\n      if (actionData[\"actionFailed\"] == true) {\n        this.setErrorStatus(\"Release action failed\");\n        return;\n      }\n    } else {\n      collision = this.sim.step(action, true);\n    }\n\n    // Log action and action data\n    let agentState = this.sim.getAgentPose();\n    let logData = {\n      action: action,\n      agentState: agentState\n    };\n\n    let objectStates = this.sim.getObjectStates();\n    let objectUnderCrosshair = this.sim.getObjectUnderCrosshair()[\n      \"nearestObjectId\"\n    ];\n    let objectDropPoint = [];\n    if (this.sim.grippedObjectId != -1) {\n      objectDropPoint = this.sim.findObjectFloorPositionUnderCrosshair()[\n        \"newObjectPosition\"\n      ];\n      objectDropPoint = this.sim.convertVector3ToVec3f(objectDropPoint);\n    }\n\n    logData[\"objectUnderCrosshair\"] = objectUnderCrosshair;\n    logData[\"nearestObjectId\"] = this.sim.nearestObjectId;\n    logData[\"grippedObjectId\"] = this.sim.grippedObjectId;\n    logData[\"objectDropPoint\"] = objectDropPoint;\n    logData[\"objectStates\"] = objectStates;\n    logData[\"collision\"] = collision;\n\n    this.psiturk.handleRecordTrialData(\"TEST\", \"handleAction\", logData);\n  }\n\n  removeActiveAction(action) {\n    const index = this.activeActions.indexOf(action);\n    if (index > -1) {\n      this.activeActions.splice(index, 1);\n    }\n  }\n\n  handleKeypressUp(key) {\n    for (let a of this.actions) {\n      if (a.keyCode === key) {\n        this.removeActiveAction(a.name);\n        break;\n      }\n    }\n  }\n\n  handleKeypress(key) {\n    for (let a of this.actions) {\n      if (a.keyCode === key) {\n        this.pushAction(a.name);\n        break;\n      }\n    }\n  }\n\n  bindKeys() {\n    var _self = this;\n    if (_self.keyBindListener) {\n      console.log(\"Keys already bound. Returning\");\n      return;\n    }\n    _self.keyBindListener = function(event) {\n      event.preventDefault();\n      _self.handleKeypress(event.keyCode);\n    };\n    document.addEventListener(\"keydown\", _self.keyBindListener, true);\n\n    _self.keyBindListener2 = function(event) {\n      event.preventDefault();\n      _self.handleKeypressUp(event.keyCode);\n    };\n    document.addEventListener(\"keyup\", _self.keyBindListener2, true);\n  }\n\n  unbindKeys() {\n    if (this.keyBindListener) {\n      document.removeEventListener(\"keydown\", this.keyBindListener, true);\n      this.keyBindListener = null;\n\n      document.removeEventListener(\"keyup\", this.keyBindListener2, true);\n      this.keyBindListener2 = null;\n    }\n  }\n}\n\nexport default PickPlaceTask;\n","// Copyright (c) Facebook, Inc. and its affiliates.\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\n/* global Module */\nimport {\n  defaultAgentConfig,\n  defaultEpisode,\n  defaultResolution,\n  taskConfigs\n} from \"./defaults\";\nimport SimEnv from \"./simenv_embind\";\nimport ObjectNavTask from \"./objectnav_task\";\nimport PickPlaceTask from \"./pick_place_task\";\nimport {\n  buildConfigFromURLParameters,\n  loadEpisode,\n  getObjectIconImgTags\n} from \"./utils\";\nimport TaskValidator from \"./task_validator\";\n\nclass WebDemo {\n  currentResolution = defaultResolution;\n\n  constructor(canvasId = \"canvas\") {\n    this.canvasId = canvasId;\n  }\n\n  initializeModules(\n    agentConfig = defaultAgentConfig,\n    episode = defaultEpisode\n  ) {\n    this.config = new Module.SimulatorConfiguration();\n    this.config.allowSliding = false;\n    if (window.config.dataset != \"objectnav\") {\n      this.config.allowSliding = true;\n    }\n    this.config.scene_id = Module.scene;\n    this.config.enablePhysics = Module.enablePhysics;\n    this.config.physicsConfigFile = Module.physicsConfigFile;\n\n    this.simenv = new SimEnv(this.config, episode, 0);\n    this.task_type = episode[\"task\"][\"type\"];\n\n    agentConfig = this.updateAgentConfigWithSensors({ ...agentConfig });\n\n    this.simenv.addAgent(agentConfig);\n    this.simenv.updateCrossHairNode(this.simenv.resolution);\n\n    this.canvasElement = document.getElementById(this.canvasId);\n\n    this.taskValidator = new TaskValidator(episode, this.simenv);\n    this.task = this.instantiateTask(window.config.dataset);\n  }\n\n  instantiateTask(dataset) {\n    let task = null;\n    if (dataset == \"objectnav\") {\n      task = new ObjectNavTask(this.simenv, {\n        canvas: this.canvasElement,\n        fps: document.getElementById(\"fps\"),\n        scope: document.getElementById(\"scope\"),\n        status: document.getElementById(\"status\"),\n        taskValidator: this.taskValidator\n      });\n    } else if (dataset == \"pick_and_place\") {\n      task = new PickPlaceTask(this.simenv, {\n        canvas: this.canvasElement,\n        fps: document.getElementById(\"fps\"),\n        inventory: document.getElementById(\"inventory\"),\n        scope: document.getElementById(\"scope\"),\n        status: document.getElementById(\"status\"),\n        taskValidator: this.taskValidator\n      });\n    }\n    return task;\n  }\n\n  setEpisode(episode) {\n    let taskInstruction = document.getElementById(\"task-instruction\");\n    let assistance = document.getElementById(\"text-assistance-1\");\n    if (taskInstruction !== undefined && taskInstruction !== null) {\n      taskInstruction.innerHTML =\n        \"<hr> <h4>Task: \" + episode.task.instruction + \"</h4> <hr>\";\n    }\n    if (assistance !== undefined && assistance !== null) {\n      let objectIconTags = getObjectIconImgTags(episode);\n      if (\n        objectIconTags[\"objects\"].length > 0 &&\n        objectIconTags[\"receptacles\"].length > 0 &&\n        episode[\"task\"][\"type\"] == \"arrangement\"\n      ) {\n        assistance.innerHTML =\n          \"<div class='object-type'> Object: </div> <ul>\" +\n          objectIconTags[\"objects\"].join(\"\\n\") +\n          \"</ul>\" +\n          \"<br/><div class='object-type'> Receptacle: </div> <ul>\" +\n          objectIconTags[\"receptacles\"].join(\"\\n\") +\n          \"</ul>\";\n      }\n      // Render only objects for cleaning task\n      if (\n        objectIconTags[\"objects\"].length > 0 &&\n        episode[\"task\"][\"type\"] == \"cleaning\"\n      ) {\n        assistance.innerHTML =\n          \"<div class='object-type'> Objects: </div> <ul>\" +\n          objectIconTags[\"objects\"].join(\"\\n\") +\n          \"</ul>\";\n      }\n    }\n    this.simenv.setEpisode(episode);\n  }\n\n  setTaskValidator(episode) {\n    this.task.setTaskValidator(episode);\n  }\n\n  runFlythrough() {\n    window.config.disableLogging = true;\n    window.config.runFlythrough = true;\n    window.config.actualTask = false;\n    this.task.reset();\n  }\n\n  runInit() {\n    window.config.disableLogging = false;\n    window.config.runFlythrough = false;\n    window.config.actualTask = true;\n    let episodeId = window.config.episodeId;\n    let episode = loadEpisode(\n      \"/data/\".concat(window.config.taskConfig.name),\n      episodeId,\n      window.config.dataset\n    );\n    this.setEpisode(episode);\n    this.setTaskValidator(episode);\n    this.task.reset();\n  }\n\n  runTrainingTask() {\n    window.config.disableLogging = true;\n    window.config.runFlythrough = false;\n    window.config.actualTask = false;\n    let trainingEpisode = window.config.taskConfig.trainingTask.name;\n    let episode = loadEpisode(\n      \"/data/\".concat(trainingEpisode),\n      0,\n      window.config.dataset\n    );\n    this.setEpisode(episode);\n    this.setTaskValidator(episode);\n    this.task.reset();\n  }\n\n  updateAgentConfigWithSensors(agentConfig = defaultAgentConfig) {\n    let taskConfig = taskConfigs[\"rearrangement\"];\n    if (window.config.dataset == \"objectnav\") {\n      taskConfig = taskConfigs[window.config.dataset];\n    }\n    const sensorConfigs = [\n      {\n        uuid: \"rgb\",\n        sensorType: Module.SensorType.COLOR,\n        position: taskConfig[\"sensorConfig\"][\"position\"],\n        hfov: 79,\n        resolution: [480, 640]\n      }\n    ];\n    const actionSpace = new Module.ActionSpace();\n    const moveActuationSpec = new Module.MapStringFloat();\n    moveActuationSpec.set(\"amount\", taskConfig[\"actuationSpec\"][\"move\"]);\n    const turnActuationSpec = new Module.MapStringFloat();\n    turnActuationSpec.set(\"amount\", taskConfig[\"actuationSpec\"][\"turn\"]);\n    const actions = taskConfig[\"actions\"];\n    for (let action in actions) {\n      action = actions[action];\n      if (action.includes(\"move\")) {\n        actionSpace.set(\n          action,\n          new Module.ActionSpec(action, moveActuationSpec)\n        );\n      } else {\n        actionSpace.set(\n          action,\n          new Module.ActionSpec(action, turnActuationSpec)\n        );\n      }\n    }\n\n    agentConfig.sensorSpecifications = sensorConfigs;\n    agentConfig.actionSpace = actionSpace;\n    agentConfig = this.updateAgentConfigWithResolution(agentConfig);\n\n    return agentConfig;\n  }\n\n  resetCanvas(resolution) {\n    this.canvasElement.width = resolution.width;\n    this.canvasElement.height = resolution.height;\n  }\n\n  updateAgentConfigWithResolution(agentConfig) {\n    agentConfig.sensorSpecifications.forEach(sensorConfig => {\n      sensorConfig.resolution = [\n        this.currentResolution.height,\n        this.currentResolution.width\n      ];\n    });\n\n    return agentConfig;\n  }\n\n  display(agentConfig = defaultAgentConfig, episode = {}) {\n    const config = buildConfigFromURLParameters();\n    if (config.useDefaultEpisode) {\n      episode = defaultEpisode;\n    }\n\n    this.initializeModules(agentConfig, episode);\n\n    this.task.init();\n    this.task.reset();\n  }\n\n  validateTask() {\n    this.task.validateTask();\n  }\n}\n\nexport default WebDemo;\n","// Copyright (c) Facebook, Inc. and its affiliates.\n// This source code is licensed under the MIT license found in the\n// LICENSE file in the root directory of this source tree.\n\n/* global FS, Module */\n\nimport WebDemo from \"./modules/web_demo\";\nimport { defaultScene, dataHome, sceneHome } from \"./modules/defaults\";\nimport \"./bindings.css\";\nimport {\n  checkWebAssemblySupport,\n  checkWebgl2Support,\n  getInfoSemanticUrl,\n  buildConfigFromURLParameters,\n  loadEpisode,\n  getEpisodeMeta,\n  getObjects,\n  getTaskConfigPath\n} from \"./modules/utils\";\n\nfunction preload(url) {\n  let file = url;\n  if (url.indexOf(\"http\") === 0) {\n    const splits = url.split(\"/\");\n    file = splits[splits.length - 1];\n  }\n  if (window.config.dataset == \"objectnav\") {\n    if (url.includes(\"semantic\")) {\n      url = url.split(\".\")[0].split(\"_\")[0] + \"/\" + url;\n    } else {\n      url = url.split(\".\")[0] + \"/\" + url;\n    }\n  }\n  FS.createPreloadedFile(\"/\", file, sceneHome.concat(url), true, false);\n  return file;\n}\n\nfunction preloadPhysConfig(url, episodeId, objectsToLoadList = null) {\n  let emDataHome = \"/data\";\n  FS.mkdir(emDataHome);\n\n  let file = url;\n  if (url.indexOf(\"http\") === 0) {\n    const splits = url.split(\"/\");\n    file = splits[splits.length - 1];\n  }\n  FS.createPreloadedFile(emDataHome, file, dataHome.concat(url), true, false);\n\n  let emObjHome = emDataHome.concat(\"/objects\");\n  FS.mkdir(emObjHome);\n\n  // Load selected objects only needed for the current episode\n  for (let objectIdx in objectsToLoadList) {\n    let physicsProperties = objectsToLoadList[objectIdx][\"physicsProperties\"];\n    let physicsPropertyName = physicsProperties.split(\"/\")[\n      physicsProperties.split(\"/\").length - 1\n    ];\n    let renderMesh = objectsToLoadList[objectIdx][\"renderMesh\"];\n    let renderMeshName = renderMesh.split(\"/\")[\n      renderMesh.split(\"/\").length - 1\n    ];\n\n    FS.createPreloadedFile(\n      emObjHome,\n      renderMeshName,\n      dataHome.concat(renderMesh),\n      true,\n      false\n    );\n    FS.createPreloadedFile(\n      emObjHome,\n      physicsPropertyName,\n      dataHome.concat(physicsProperties),\n      true,\n      false\n    );\n  }\n\n  return emDataHome.concat(\"/\".concat(file));\n}\n\nfunction preloadTask(datasetPath) {\n  let emDataHome = \"/data\";\n\n  if (datasetPath !== undefined) {\n    let splittedPath = datasetPath.split(\"/\");\n    let taskName = splittedPath[splittedPath.length - 1];\n\n    FS.createPreloadedFile(emDataHome, taskName, datasetPath, true, false);\n  }\n}\n\nModule.preRun.push(() => {\n  const args = decodeURIComponent(window.location.search.substr(1))\n    .trim()\n    .split(\"&\");\n  for (let i = 0; i != args.length; ++i) {\n    let j = args[i].indexOf(\"=\");\n    /* Key + value */\n    if (j != -1) {\n      Module.arguments.push(\"--\" + args[i].substring(0, j));\n      Module.arguments.push(args[i].substring(j + 1));\n\n      /* Just key */\n    } else {\n      Module.arguments.push(\"--\" + args[i]);\n    }\n  }\n\n  let config = {};\n  config.scene = defaultScene;\n  buildConfigFromURLParameters(config);\n\n  window.config = config;\n  let sceneId = config.scene.split(\".\")[0];\n  let datasetPath = getTaskConfigPath(sceneId, window.config.dataset);\n  window.config.datasetPath = datasetPath;\n  let episodeId = config.episodeId;\n\n  let episodeMeta = getEpisodeMeta(datasetPath, episodeId);\n  let trainingEpisodeMeta = getEpisodeMeta(datasetPath, 0);\n  let objectsToLoad = getObjects(\n    episodeMeta,\n    trainingEpisodeMeta,\n    window.config.dataset\n  );\n\n  const scene = config.scene;\n  Module.scene = preload(scene);\n\n  const physicsConfigFile = window.config.defaultPhysConfig;\n  Module.physicsConfigFile = preloadPhysConfig(\n    physicsConfigFile,\n    episodeId,\n    objectsToLoad\n  );\n\n  Module.enablePhysics = window.config.enablePhysics === \"true\";\n  window.config.runFlythrough = window.config.runFlythrough === \"true\";\n\n  preloadTask(datasetPath);\n\n  const fileNoExtension = scene.substr(0, scene.lastIndexOf(\".\"));\n\n  if (!window.config.recomputeNavMesh) {\n    preload(fileNoExtension + \".navmesh\");\n    preload(fileNoExtension + \".stage_config.json\");\n  }\n  if (config.semantic === \"mp3d\") {\n    preload(fileNoExtension + \".house\");\n    preload(fileNoExtension + \"_semantic.ply\");\n  } else if (config.semantic === \"replica\") {\n    preload(getInfoSemanticUrl(config.scene));\n  }\n});\n\nModule.onRuntimeInitialized = () => {\n  console.log(\"hsim_bindings initialized\");\n  let demo;\n  demo = new WebDemo();\n\n  if (window.config.datasetPath !== undefined) {\n    let sceneId = window.config.scene.split(\".\")[0];\n    let episode = loadEpisode(\n      \"/data/\".concat(sceneId + \".json\"),\n      window.config.episodeId,\n      window.config.dataset\n    );\n    demo.display(undefined, episode);\n  } else {\n    demo.display();\n  }\n  if (window.config.runFlythrough === true) {\n    demo.runFlythrough();\n  }\n  window.demo = demo;\n};\n\nfunction checkSupport() {\n  const webgl2Support = checkWebgl2Support();\n  let message = \"\";\n\n  if (!webgl2Support) {\n    message = \"WebGL2 is not supported on your browser. \";\n  } else if (webgl2Support === 1) {\n    message = \"WebGL2 is supported on your browser, but not enabled. \";\n  }\n\n  const webasmSupport = checkWebAssemblySupport();\n\n  if (!webasmSupport) {\n    message += \"Web Assembly is not supported in your browser\";\n  }\n\n  if (message.length > 0) {\n    const warningElement = document.getElementById(\"warning\");\n    warningElement.innerHTML = message;\n    // Remove the default hidden class\n    warningElement.className = \"\";\n  }\n}\n\ncheckSupport();\n"],"sourceRoot":""}